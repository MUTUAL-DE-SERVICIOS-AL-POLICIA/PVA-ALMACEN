.page-header
  %h2
    Salida de subartículos por unidad

    .pull-right
      = form_tag estadisticas_reportes_path, method: :get, class: 'form-inline' do
        .form-group
          %label.sr-only{for: 'fecha-desde'} Desde
          = text_field_tag :desde, params[:desde], class: 'form-control fecha-buscador', id: 'fecha-desde', placeholder: 'Desde fecha'
        .form-group
          %label.sr-only{for: 'fecha-hasta'} Hasta
          = text_field_tag :hasta, params[:hasta], class: 'form-control fecha-buscador', id: 'fecha-hasta', placeholder: 'Hasta fecha'
        %button{type: 'submit', class: 'btn btn-primary', title: 'Generar kardexes de todos los subartículos'}
          %span.glyphicon.glyphicon-search

- auxiliar = {}
- c1 = c2 = 0
%table.table.table-condensed.table-hover.table-responsive.table-bordered
  %tbody
    - @resultados.each do |fila|
      - if auxiliar['material'] != fila['material']
        - c2 = 0
        %tr.info
          %th.number= c1 += 1
          %th.number= link_to(fila['codigo'], subarticle_path(fila['subarticulo_id'], desde: params[:desde], hasta: params[:hasta]))
          %th{colspan: 4}= fila['material']
          %th.number TOTAL SALIDA
          %th.number= mostrar_entero_float sumar_total_salidas(@resultados, fila)
          %th
        %tr.warning
          %th.number Nro
          %th.text-center Mes
          %th Unidad
          %th Detalle
          %th.text-center Fecha
          %th.text-center Nro Solicitud
          %th Unidad de medida
          %th.number Salida
          %th.number Saldo
      %tr
        %td.number= c2 += 1
        %td.text-center= fila['fecha'].strftime('%m/%Y')
        %td= fila['unidad']
        %td= fila['detalle']
        %td.text-center= l(fila['fecha'], format: :version)
        %td.text-center= link_to("##{fila['nro_solicitud']}", request_path(id: fila['modelo_id']))
        %td= mostrar_entero_float(fila['unidad_medida'])
        %td.number= mostrar_entero_float(fila['cantidad'])
        %td.number= mostrar_entero_float(fila['saldo'])
      - auxiliar = fila
