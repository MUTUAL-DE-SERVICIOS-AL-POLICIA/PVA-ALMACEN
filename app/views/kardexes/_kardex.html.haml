- kp = kardex.kardex_prices.count
- final = final || false
- initial = initial || false
- if final == false && initial == false
  %tr
    %td.text-center{rowspan: kp}
      = l kardex.kardex_date.to_date, format: :default
    %td.text-center{rowspan: kp}= kardex.invoice_number
    %td.text-center{rowspan: kp}= kardex.order_number
    %td{rowspan: kp}= kardex.detail
    - kardex.kardex_prices.each_with_index do |price, index|
      - if index > 0
        %tr= render 'kardex_prices', price: price
      - else
        = render 'kardex_prices', price: price
- else
  %tr{style: 'font-weight: bold;'}
    %td.text-center{rowspan: kp}
      - date = final==false ? kardex.kardex_date : Date.today.end_of_year
      = l date.to_date, format: :default
    %td.text-center{rowspan: kp} 0
    %td.text-center{rowspan: kp} 0
    %td{rowspan: kp}= final==false ? 'SALDO INICIAL' : 'SALDO FINAL'
    - kardex.kardex_prices.each_with_index do |price, index|
      - if index > 0
        %tr{style: 'font-weight: bold;'}
          %td.text-center 0
          %td.text-center 0
          %td.text-center= price.balance_quantities
          %td.number= number_with_delimiter price.unit_cost
          %td.number= '0.00'
          %td.number= '0.00'
          %td.number= number_with_delimiter price.balance_amount
      - else
        %td.text-center 0
        %td.text-center 0
        %td.text-center= price.balance_quantities
        %td.number= number_with_delimiter price.unit_cost
        %td.number= '0.00'
        %td.number= '0.00'
        %td.number= number_with_delimiter price.balance_amount